#############################################################################
#
# The settings below have been inserted by the configure command.
#
# If they do not work, you can either
#
# - try to specify the right settings to configure via the "configure" 
#   command line options
# - or edit Makefile.template directly. E.g., if CFG_MOTIF_LIBS seems
#   to hold the wrong values, search for CFG_MOTIF_LIBS in Makefile.template,
#   read the comments in the respective section, and specify the right value 
#   for MOTIF_LIBS there.
#
#   DO NOT EDIT THIS FILE OR ANY OF THE CFG_* VALUES, as they will be deleted
#   or overridden by certain make options (such as 'make distclean')
#
#############################################################################

CFLAGS = -O2 -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE 
LDFLAGS =   
SHELL = /bin/bash
CFG_PACKAGE = pngpack
CFG_VERSION = 0.11
MAKE = /usr/bin/make
CC = /usr/bin/gcc
CFG_SRCDIR = /home/carsten/work/dvdisaster-0.71.24/tools
CFG_PREFIX = /usr/local
CFG_BINDIR = /usr/local/bin
CFG_BZ2_INCL = 
CFG_BZ2_LFLAGS = 
CFG_BZ2_LIBS = -lbz2
CFG_PNG_INCL = 
CFG_PNG_LFLAGS = 
CFG_PNG_LIBS = -lpng

CFG_CFILES =  aux.c codec.c decimate.c md5.c pngio.c pngpack.c
CFG_OFILES =  aux.o codec.o decimate.o md5.o pngio.o pngpack.o

CFG_SYS_OPTIONS  = -DSYS_LINUX
CFG_EXE_SUFFIX   = 
CFG_HAVE_OPTIONS =  -DHAVE_LITTLE_ENDIAN
CFG_WITH_OPTIONS =  -DWITH_MEMDEBUG_NO
CFG_OTHER_OPTIONS = 

######################################################################
# Take over variables from configure
######################################################################

VERSION = $(CFG_VERSION)

SRCDIR = $(CFG_SRCDIR)
PREFIX = $(CFG_PREFIX)
BINDIR = $(CFG_BINDIR)

EFENCE_LFLAGS = $(CFG_EFENCE_LFLAGS)
EFENCE_LIBS   = $(CFG_EFENCE_LIBS)

BZ2_INCL   = $(CFG_BZ2_INCL)
BZ2_LFLAGS = $(CFG_BZ2_LFLAGS)
BZ2_LIBS   = $(CFG_BZ2_LIBS)

PNG_INCL   = $(CFG_PNG_INCL)
PNG_LFLAGS = $(CFG_PNG_LFLAGS)
PNG_LIBS   = $(CFG_PNG_LIBS)

SYS_OPTIONS  = $(CFG_SYS_OPTIONS)
HAVE_OPTIONS = $(CFG_HAVE_OPTIONS)
WITH_OPTIONS = $(CFG_WITH_OPTIONS)
EXE_SUFFIX   = $(CFG_EXE_SUFFIX)

LOCATIONS = -DSRCDIR=\"$(SRCDIR)\" -DBINDIR=\"$(BINDIR)\" -DDOCDIR=\"$(DOCDIR)\" -DLOCALEDIR=\"$(LOCALEDIR)\"
COPTS = $(CFLAGS) $(LOCATIONS) $(SYS_OPTIONS) $(HAVE_OPTIONS) $(WITH_OPTIONS) $(BZ2_INCL) $(PNG_INCL)
LOPTS = $(LDFLAGS) $(BZ2_LFLAGS) $(PNG_LFLAGS)

LIBS = $(EFENCE_LIBS) $(BZ2_LIBS) $(PNG_LIBS) -lm

CFILES = $(CFG_CFILES)
OFILES = $(CFG_OFILES)

######################################################################
# Compilation related
######################################################################

.PHONY : show

.c.o:
	@echo "Compiling:" $*.c
	@$(CC) $(COPTS) -DPNGPACK  -c $*.c

# Note that we build a self-contained (statically linked) pngpack.exe
# under Windows so that we do not have to ship the .dll files for
# bzip2, libpng, and zlib.

pngpack: $(OFILES)
	@echo "Linking  : pngpack";
	@if test $(CFG_SYS_OPTIONS) == -DSYS_MINGW; \
	then $(CC) $(LOPTS) $(OFILES) $(LIBS) -lz --static -o pngpack; \
	else $(CC) $(LOPTS) $(OFILES) $(LIBS) -o pngpack; \
	fi

show: 
	@echo -e "Current build configuration in ./Makefile:\n" 
	@echo "VERSION      = " $(VERSION)
	@echo "CC           = " $(CC)
	@echo "MAKE         = " $(MAKE)
	@echo "SHELL        = " $(SHELL)
	@echo "SRCDIR       = " $(SRCDIR)
	@echo "PREFIX       = " $(PREFIX)
	@echo "BINDIR       = " $(BINDIR)
	@echo
	@echo "EFENCE_LFLAGS= " $(EFENCE_LFLAGS)
	@echo "EFENCE_LIBS  = " $(EFENCE_LIBS)
	@echo
	@echo "PNG_LFLAGS   = " $(PNG_LFLAGS)
	@echo "PNG_LIBS     = " $(PNG_LIBS)
	@echo
	@echo "SYS_OPTIONS  = " $(SYS_OPTIONS)
	@echo "EXE_SUFFIX   = " $(EXE_SUFFIX)
	@echo "HAVE_OPTIONS = " $(HAVE_OPTIONS)
	@echo "WITH_OPTIONS = " $(WITH_OPTIONS)
	@echo
	@echo "CFLAGS       = " $(CFLAGS)
	@echo "COPTS        = " $(COPTS)
	@echo "LDFLAGS      = " $(LDFLAGS)
	@echo "LOPTS        = " $(LOPTS)
	@echo "LIBS         = " $(LIBS)


######################################################################
# Distribution management
######################################################################

.PHONY : clean distclean

distclean:
	@echo "Removing local .png and .pngpack files in ./tools"
	@rm -f *.png
	@echo "Removing symbolic links in ./tools"
	@rm -f md5.h md5.c
	@echo "Removing configuration files in ./tools"
	@rm -f configure.log Makefile.config Makefile
	@echo "all:" >>Makefile
	@echo -e "\t@echo" >>Makefile
	@echo -e "\t@echo \"Please create a Makefile by entering \\\"./configure\\\" first\"" >>Makefile
	@echo -e "\t@echo" >>Makefile

clean:
	@echo "Removing rebuildable files in ./tools"
	@rm -rf *.o pngpack *.exe *.dll *.dll.a core *.stackdump
	@find . -name \*\~ -print | xargs rm -f;
